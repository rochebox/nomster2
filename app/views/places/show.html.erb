<!--This is the view from the "show" controller action from Lesson 21 -->
<!-- this shows the full record of the place (restaurant) -->

<div class="booyah-box col-xs-8 col-xs-offset-2">
	<h1 class="brand-font light-blue-color text-shadow-red heading-size"><%= @place.name %></h1>
	<i><%= @place.address %></i>
	<br/><br/>
	<p><%= @place.description %></p>
    <br />
	<!--here come the tags to place a google map Lesson 30 -->
	<% if @place.latitude.present? && @place.longitude.present? %>
		    <script>

		      function initMap() {
		        var myLatLng = {lat: <%= @place.latitude %>, lng: <%= @place.longitude %>};

		        var map = new google.maps.Map(document.getElementById('map'), {
		          zoom: 17,
		          center: myLatLng
		        });

		        var marker = new google.maps.Marker({
		          position: myLatLng,
		          map: map,
		          title: 'Hello World!'
		        });
		      }
		    </script>
		    <script async defer
		    src="https://maps.googleapis.com/maps/api/js?key=AIzaSyCzSJ-karImYqxutzcv3rCOwtyL7VCy2pk&callback=initMap">
		    </script>

		    <!-- moved from top in example... -->
			<div id="map"></div>
<% end %>

<br />

	<div class="pull-right">
		<% if current_user && current_user == @place.user %>
   		 <%= link_to 'Edit', edit_place_path(@place), class: 'btn btn-primary btn-lg' %>
   		  <%= link_to 'Delete', place_path(@place), method: :delete, data: { confirm: 'Are you completely sure you want to delete this restaurant?'}, class: 'btn btn-danger btn-lg' %>
   		<% end %>
   		
    </div>
</div>

<div class="clear"></div>

<!-- Button trigger modal -->
<button class="btn btn-primary btn-lg" data-toggle="modal" data-target="#myModal">
  Add a comment!
</button>

<!-- Modal -->
<div class="modal fade" id="myModal" tabindex="-1" role="dialog" aria-labelledby="myModalLabel" aria-hidden="true">
  <div class="modal-dialog">
    <div class="modal-content">
    <!-- working here... -->	
      <div class="modal-header">
        <button type="button" class="close" data-dismiss="modal" aria-hidden="true">&times;</button>
        <h4 class="modal-title" id="myModalLabel">Add your comment!</h4>
      </div>
     
 		<!-- I think this is where the really meat for the comments go... -->
        <%= simple_form_for @comment, url: place_comments_path(@place) do |f| %>
        <div class="modal-body"> 
          <%= f.input :message %>
          <%= f.input :rating, as: :select, collection: Comment::RATINGS %>
         
      </div>
      <div class="modal-footer">
        <button type="button" class="btn btn-default" data-dismiss="modal">Close</button>
         <%= f.submit "Add a Comment", class: 'btn btn-primary' %>
      </div>
     <% end %>
    </div>
  </div>
</div>

<h1>Comments</h1>
<% @place.comments.each do |comment| %>
	<div>
		<blockquote>
			<% if comment.humanized_rating.present? %>
				<b><%= comment.humanized_rating %></b> -
			<% end %>	
			<%= comment.message %>
			<small><%= comment.user.email %></small>
		</blockquote>
	</div>
<% end %>
